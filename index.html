<div id="cncai-root">⏳ جاري التحميل...</div>

<script>
const root = document.getElementById('cncai-root');

function waitForCV() {
  return new Promise((resolve, reject) => {
    const check = setInterval(() => {
      if (cv && cv.Mat) {
        clearInterval(check);
        resolve();
      }
    }, 50);
    setTimeout(() => {
      clearInterval(check);
      reject('OpenCV لم يتم تحميله خلال الوقت المحدد');
    }, 15000);
  });
}

async function initApp() {
  try {
    root.innerText = '⏳ انتظار OpenCV...';
    await waitForCV();
    root.innerText = '✅ OpenCV جاهز!';

    // استدعاء الدوال المحلية بعد التأكد من تحميل OpenCV
    if (typeof initCV === 'function') initCV();
    if (typeof initDebugOverlay === 'function') initDebugOverlay();
    if (typeof initUI === 'function') initUI();

    console.log('✅ CncAi جاهز للعمل!');
    root.innerText = '✅ CncAi جاهز للعمل!';
  } catch (err) {
    root.innerText = '❌ فشل تحميل OpenCV';
    console.error(err);
  }
}

// تشغيل التطبيق
initApp();
</script>

<!-- تحميل ملفات JS المحلية -->
<script src="/Ai/js/cv/cv-processing.js"></script>
<script src="/Ai/js/ui/ui-init.js"></script>
<script src="/Ai/js/core/debugOverlay.js"></script>
<script src="/Ai/js/core/taskManager.js"></script>
